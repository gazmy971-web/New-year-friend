<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Staff Raffle Spinner</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align:center; background:#f0f2f5; color: #333; }
h2 { color: #2c3e50; margin-bottom: 10px; }
button { padding:12px 25px; font-size:16px; margin:10px; border:none; border-radius:50px;
background:#007bff; color:white; cursor:pointer; transition: background 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
button:hover { background:#0056b3; }
button:disabled { background: #ccc; cursor: not-allowed; }
#result { font-size:24px; margin-top:20px; font-weight:bold; color: #28a745; min-height: 40px; }
select { padding: 10px 15px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px; }
table { margin:auto; padding:10px; border-collapse:collapse; font-size:16px; display:none; margin-top: 30px; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; width: 80%; max-width: 600px; }
th, td { border:1px solid #ddd; padding:12px; text-align: left; }
th { background-color: #f8f9fa; font-weight: bold; }
tr:nth-child(even) { background-color: #f9f9f9; }
</style>
</head>
<body>

<h2>ğŸ¡ Staff Raffle Spinner</h2>
<p>Ø§Ø®ØªØ§Ø± Ø§Ø³Ù…Ùƒ ÙˆØ§Ø¶ØºØ· Spin (ÙƒÙ„ Ø´Ø®Øµ Ù„Ù‡ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)</p>

<select id="selector">
    <option value="" disabled selected>-- Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒ --</option>
</select>

<br>
<canvas id="wheel" width="450" height="450"></canvas>
<br>

<button onclick="spin()" id="spinBtn">SPIN ğŸ²</button>

<div id="result"></div>

<hr style="margin: 40px 0; border: 0; border-top: 1px solid #ddd;">

<button onclick="revealResults()" style="background-color: #6c757d;">Show Results (Admin Only ğŸ”’)</button>
<table id="resultsTable">
  <thead>
    <tr><th>Ø§Ù„Ø´Ø®Øµ (Spinner)</th><th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ§Ø±Ù‡ (Selected)</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ - ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù‡Ù†Ø§
let originalNames = ["Edress","Jijo","Ajay","Abualsoud","Rinu","Abdelaziz","Khalid","Lija","Somi","Karthik","Cleo","Wala","Wael","Hashem","Rini","Sowmya","Margeret","Sreepa","Anju tom","Ruksana","Ambia","Jesmol","Hossam","George","Shaza","Asma","Fatima"];

let remainingTargets = [...originalNames]; // Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„ÙÙˆØ²
let results = {};
let namesOnWheel = []; // Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¬Ù„Ø©
let arc = 0;
let startAngle = 0;
let spinning = false;

const selector = document.getElementById("selector");

// ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
originalNames.sort().forEach(n => {
    const opt = document.createElement("option");
    opt.value = opt.textContent = n;
    selector.appendChild(opt);
});

const wheel = document.getElementById("wheel");
const ctx = wheel.getContext("2d");

function drawWheel() {
    if (namesOnWheel.length === 0) return;
    arc = (2 * Math.PI) / namesOnWheel.length;
    
    for (let i = 0; i < namesOnWheel.length; i++) {
        let angle = startAngle + i * arc;
        ctx.beginPath();
        // Ø£Ù„ÙˆØ§Ù† Ù…ØªØ¨Ø§Ø¯Ù„Ø© Ù„Ù„Ø¹Ø¬Ù„Ø©
        ctx.fillStyle = i % 2 === 0 ? "#FFD700" : "#FFC107"; // Gold & Amber
        ctx.moveTo(225, 225);
        ctx.arc(225, 225, 225, angle, angle + arc);
        ctx.fill();
        ctx.save();
        ctx.fillStyle = "black";
        ctx.translate(225, 225);
        ctx.rotate(angle + arc / 2);
        ctx.textAlign = "right";
        ctx.font = "bold 14px Arial";
        ctx.fillText(namesOnWheel[i], 200, 5);
        ctx.restore();
    }
}

function prepareWheel(list) {
    namesOnWheel = [...list];
    ctx.clearRect(0,0,450,450);
    drawWheel();
}

// Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¬Ù„Ø©
prepareWheel(originalNames);

function spin() {
    if (spinning) return;
    
    let person = selector.value;
    if (!person) {
        alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£ÙˆÙ„Ø§Ù‹!");
        return;
    }
    
    // Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ø´Ø®Øµ Ù†ÙØ³Ù‡ Ù…Ù† Ø§Ù„Ø¹Ø¬Ù„Ø© (Ù„Ø§ ÙŠØ®ØªØ§Ø± Ù†ÙØ³Ù‡)
    // ÙˆØ§Ø³ØªØ¨Ø¹Ø§Ø¯ Ù…Ù† ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡Ù… Ø³Ø§Ø¨Ù‚Ø§Ù‹ (remainingTargets)
    let availableOptions = remainingTargets.filter(n => n !== person);
    
    if (availableOptions.length === 0) {
        alert("Ù„Ù… ÙŠØªØ¨Ù‚ Ø£Ø³Ù…Ø§Ø¡ Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± (Ø£Ùˆ Ø¨Ù‚ÙŠ Ø§Ø³Ù…Ùƒ ÙÙ‚Ø·)!");
        return;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¬Ù„Ø© Ù„ØªØ´Ù…Ù„ ÙÙ‚Ø· Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ† Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±
    prepareWheel(availableOptions);
    
    spinning = true;
    document.getElementById("result").innerText = "Spinning...";
    document.getElementById("spinBtn").disabled = true; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†

    let spinAngle = Math.random() * 3000 + 3000; 
    let duration = 3000;
    let start = null;
    
    function animate(timestamp) {
        if (!start) start = timestamp;
        let progress = timestamp - start;
        
        startAngle += (spinAngle * (1 - progress/duration) / 100); 

        ctx.clearRect(0, 0, 450, 450);
        drawWheel();
        
        if (progress < duration) {
            requestAnimationFrame(animate);
        } else {
            spinning = false;
            document.getElementById("spinBtn").disabled = false;
            finalizePick(person, availableOptions);
        }
    }
    requestAnimationFrame(animate);
}

function finalizePick(person, list) {
    let index = Math.floor((list.length - (startAngle % (2 * Math.PI)) / arc) % list.length);
    if (index < 0) index += list.length;
    
    let selected = list[index];
    
    results[person] = selected;
    remainingTargets = remainingTargets.filter(n => n !== selected);
    
    document.getElementById("result").innerText = "ğŸ‰ " + selected + " ğŸ‰";
    
    // Ø­Ø°Ù Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ Ù‚Ø§Ù… Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    removePersonFromDropdown(person);
    
    prepareWheel(originalNames); 
    updateResultsTable();
}

function removePersonFromDropdown(personName) {
    for (let i = 0; i < selector.options.length; i++) {
        if (selector.options[i].value === personName) {
            selector.remove(i);
            break;
        }
    }
    selector.value = "";
}

function updateResultsTable(){
  const table = document.getElementById('resultsTable');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = ""; 
  
  for (let [p, s] of Object.entries(results)) {
      let row = tbody.insertRow();
      let cell1 = row.insertCell(0);
      let cell2 = row.insertCell(1);
      cell1.innerText = p;
      cell2.innerText = s;
  }
}

// Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±
function revealResults() {
  const table = document.getElementById('resultsTable');
  
  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…ÙØªÙˆØ­Ø§Ù‹ Ø¨Ø§Ù„ÙØ¹Ù„ØŒ Ù‚Ù… Ø¨Ø¥Ø®ÙØ§Ø¦Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© (Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ø¨Ø§Ø³ÙˆØ±Ø¯ Ù„Ù„Ø¥ØºÙ„Ø§Ù‚)
  if (table.style.display === 'table') {
      table.style.display = 'none';
      return;
  }

  // Ø·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
  let password = prompt("ğŸ” Enter Admin Password:");
  
  if (password === "9090") {
      table.style.display = 'table';
      updateResultsTable();
  } else if (password !== null) {
      alert("âŒ Wrong Password! Access Denied.");
  }
}
</script>

</body>
</html>
